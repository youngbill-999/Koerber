<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
 <HEAD>
 <LINK REL="STYLESHEET" TYPE="text/css" HREF="../../plsqldoc.css">
 <TITLE>View SAC_V_STOCKAVAILCHECK</TITLE>
 <META name="object" content="VIEW">
 <META name="name" content="10.9.92.109:1521/INCOMPD INWMS.SAC_V_STOCKAVAILCHECK">
 <META name="description" content="">
 <META name="columns" content="ID_SAC ID_SITE ID_CLIENT ID_ARTICLE TYP_STOCK TYP_LOCK SEP_CRIT_01 SEP_CRIT_02 SEP_CRIT_03 SEP_CRIT_04 SEP_CRIT_05 SEP_CRIT_06 SEP_CRIT_07 SEP_CRIT_08 SEP_CRIT_09 SEP_CRIT_10 QTY_AVAILABLE QTY_GLOBRES">
</HEAD>
<BODY>
<TABLE WIDTH="100%"><TR>
<TD><P ALIGN="LEFT"><STRONG><SMALL>INWMS@10.9.92.109:1521/INCOMPD</SMALL></STRONG></TD>
<TD><P ALIGN="RIGHT"><STRONG><SMALL><A HREF="../../index.html">index</A></SMALL></STRONG></TD>
</TR></TABLE>
<TABLE CLASS="MAIN_TABLE"><TR><TD CLASS="DESC_TEXT">
<P CLASS="MAIN_TITLE">View SAC_V_STOCKAVAILCHECK</P>

</TD></TR></TABLE>
<HR>
<A NAME="Columns"></A>
<TABLE CLASS="SUB_TABLE"><TR><TD CLASS="SUB_TITLE">
Columns
</TD></TR></TABLE>
<TABLE CLASS="SIMPLE_TABLE">
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM"><U>
Name
</U>
</TD>
<TD VALIGN="TOP" CLASS="LIST_ITEM"><U>
Type
</U>
</TD>
<TD VALIGN="TOP" CLASS="LIST_ITEM"><U>
Optional
</U>
</TD>
<TD VALIGN="TOP" CLASS="LIST_ITEM"><U>
Default
</U>
</TD>
<TD VALIGN="TOP" CLASS="LIST_ITEM"><U>
Comments
</U>
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
ID_SAC
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(1544)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
ID_SITE
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(48)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
ID_CLIENT
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(48)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
ID_ARTICLE
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(160)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
TYP_STOCK
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(8)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
TYP_LOCK
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(24)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
SEP_CRIT_01
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(120)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
SEP_CRIT_02
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(120)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
SEP_CRIT_03
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(120)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
SEP_CRIT_04
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(120)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
SEP_CRIT_05
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(120)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
SEP_CRIT_06
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(120)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
SEP_CRIT_07
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(120)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
SEP_CRIT_08
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(120)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
SEP_CRIT_09
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(120)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
SEP_CRIT_10
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
VARCHAR2(120)
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
QTY_AVAILABLE
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
NUMBER
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
<TR>
<TD VALIGN="TOP" CLASS="LIST_ITEM">
QTY_GLOBRES
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
NUMBER
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
Y
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
<TD VALIGN="TOP" CLASS="DESC_TEXT">
&nbsp;
</TD>
</TR>
</TABLE>
<HR>
<A NAME="SQL"></A>
<TABLE CLASS="SUB_TABLE"><TR><TD CLASS="SUB_TITLE">
SQL
</TD></TR></TABLE><PRE CLASS="DECL_TEXT">
create or replace view sac_v_stockavailcheck as
(
   select           id_site
          || '@' || id_client
          || '@' || id_article
          || '@' || typ_stock
          || '@' || typ_lock
          || '@' || sep_crit_01
          || '@' || sep_crit_02
          || '@' || sep_crit_03
          || '@' || sep_crit_04
          || '@' || sep_crit_05
          || '@' || sep_crit_06
          || '@' || sep_crit_07
          || '@' || sep_crit_08
          || '@' || sep_crit_09
          || '@' || sep_crit_10 as id_sac,
          id_site,
          id_client,
          id_article,
          typ_stock,
          typ_lock,
          sep_crit_01,
          sep_crit_02,
          sep_crit_03,
          sep_crit_04,
          sep_crit_05,
          sep_crit_06,
          sep_crit_07,
          sep_crit_08,
          sep_crit_09,
          sep_crit_10,
          sum ( qty_available - qty_reserved ) as qty_available,
          sum ( qty_globres )                  as qty_globres
     from (   select qt.id_site,
                     qt.id_client,
                     qt.id_article,
                     qt.typ_stock,
                     qt.typ_lock,
                     qt.sep_crit_01,
                     qt.sep_crit_02,
                     qt.sep_crit_03,
                     qt.sep_crit_04,
                     qt.sep_crit_05,
                     qt.sep_crit_06,
                     qt.sep_crit_07,
                     qt.sep_crit_08,
                     qt.sep_crit_09,
                     qt.sep_crit_10,
                     sum ( qt.qty_available )  as qty_available,
                     0                         as qty_globres,
                     0                         as qty_reserved
                from im_quantum qt
               where qt.qty_available    > 0
            group by qt.id_site,
                     qt.id_client,
                     qt.id_article,
                     qt.typ_stock,
                     qt.typ_lock,
                     qt.sep_crit_01,
                     qt.sep_crit_02,
                     qt.sep_crit_03,
                     qt.sep_crit_04,
                     qt.sep_crit_05,
                     qt.sep_crit_06,
                     qt.sep_crit_07,
                     qt.sep_crit_08,
                     qt.sep_crit_09,
                     qt.sep_crit_10
               union
              select oi.id_site,
                     oi.id_client_art          as id_client,
                     oi.id_article,
                     oi.typ_stock,
                     oi.typ_lock,
                     oi.sep_crit_01,
                     oi.sep_crit_02,
                     oi.sep_crit_03,
                     oi.sep_crit_04,
                     oi.sep_crit_05,
                     oi.sep_crit_06,
                     oi.sep_crit_07,
                     oi.sep_crit_08,
                     oi.sep_crit_09,
                     oi.sep_crit_10,
                     0                         as qty_available,
                     sum (   oi.qty_target
                           - oi.qty_reserved
                           - oi.qty_canceled ) as qty_globres,
                     0                         as qty_reserved
               from gi_order_item oi,
                    gi_order o
              where oi.id_site           = o.id_site
                and oi.id_client         = o.id_client
                and oi.id_order          = o.id_order
                and oi.num_partial_order = o.num_partial_order
                and o.stat              >= '12' -- GI_ORDER.STAT:      SAC_RELEASED
                and o.stat               < '30' -- GI_ORDER.STAT:      RES_FINISHED
                and oi.stat              > '15' -- GI_ORDER_ITEM_STAT: SAC_ERROR
                and oi.stat              < '30' -- GI_ORDER_ITEM_STAT: RES_FINISHED
           group by oi.id_site,
                    oi.id_client_art,
                    oi.id_article,
                    oi.typ_stock,
                    oi.typ_lock,
                    oi.sep_crit_01,
                    oi.sep_crit_02,
                    oi.sep_crit_03,
                    oi.sep_crit_04,
                    oi.sep_crit_05,
                    oi.sep_crit_06,
                    oi.sep_crit_07,
                    oi.sep_crit_08,
                    oi.sep_crit_09,
                    oi.sep_crit_10
               union
              select hr.id_site,
                     hr.id_client,
                     hr.id_article,
                     hr.typ_stock,
                     hr.typ_lock,
                     hr.sep_crit_01,
                     hr.sep_crit_02,
                     hr.sep_crit_03,
                     hr.sep_crit_04,
                     hr.sep_crit_05,
                     hr.sep_crit_06,
                     hr.sep_crit_07,
                     hr.sep_crit_08,
                     hr.sep_crit_09,
                     hr.sep_crit_10,
                     0                         as qty_available,
                     0                         as qty_globres,
                     sum ( hr.qty_reserved )   as qty_reserved
                from im_high_level_reservation hr
            group by hr.id_site,
                     hr.id_client,
                     hr.id_article,
                     hr.typ_stock,
                     hr.typ_lock,
                     hr.sep_crit_01,
                     hr.sep_crit_02,
                     hr.sep_crit_03,
                     hr.sep_crit_04,
                     hr.sep_crit_05,
                     hr.sep_crit_06,
                     hr.sep_crit_07,
                     hr.sep_crit_08,
                     hr.sep_crit_09,
                     hr.sep_crit_10
          )
group by id_site,
          id_client,
          id_article,
          typ_stock,
          typ_lock,
          sep_crit_01,
          sep_crit_02,
          sep_crit_03,
          sep_crit_04,
          sep_crit_05,
          sep_crit_06,
          sep_crit_07,
          sep_crit_08,
          sep_crit_09,
          sep_crit_10
)
;
</PRE>
<P>&nbsp;</P>
<P>&nbsp;</P>
</BODY>
</HTML>
